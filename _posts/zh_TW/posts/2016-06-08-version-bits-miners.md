---
type: posts
layout: post
lang: zh_TW
name: version-bits-faq-miners
id: zh_tw-version-bits-faq-miners
title: 針對礦工的版本位常見為題
permalink: /zh_TW/2016/06/08/version-bits-miners-faq/
version: 1
excerpt: 版本位允許礦工嚮外界示意他們可以驗證軟分叉規則。它還允許多達29個軟分叉同時被實施。
---

## 什麼是版本位 BIP9?

版本位 BIP9 係統是為比特幣共識規則引入嚮後兼容規則的一種規則變更，稱為軟分叉。
版本位允許礦工嚮外界示意他們可以驗證軟分叉規則。它還允許多達29個軟分叉同時被實施。
如何激活版本位?
版位無需激活，它隻是礦工在塊頭nVersion字段設定的位信息，提示針對某個軟分叉已經準備就緒的一個簡單的方式。
什麼是軟分叉超時?
軟分叉有一個開始時間和一個超時，在此期間是該提議的活動時間。軟分叉隻能在起始時間和超時之間被激活。如果軟分叉在到達超時時還冇有被激活，軟分叉提議失敗，並且即使被通知也不會激活。
什麼是激活工作流?

## 在版本位下麵，一個軟分叉提議要經過如下的工作流:

-	[DEFINED] -> [STARTED] -> [LOCKED_IN] -> [ACTIVE]

或者

-	[DEFINED] -> [STARTED] -> [FAILED]

![version bits state diagram](https://raw.githubusercontent.com/bitcoin/bips/master/bip-0009/states.png)

比特幣網路每 2016 個區塊變更挖礦難度；此時版本位將觀察前麵 2016 個區塊的視窗，看看有多少區塊對指定的軟分叉釋放信號。如果 95％ 區塊對軟分叉釋放就緒信號，狀態從[STARTED] 變化至 [LOCKED_IN]。

在 `[LOCKED_IN]` 的時間為一個難度調整周期，即 2016 區塊。節點軟體警告將有一個升級。

## 什麼是版本位?

當冇有軟分叉被通知時，礦工應當將版本字段設定成 '0x20000000'。

## 礦工該何時設定位信息?

若要通知軟分叉的就緒狀態，礦工需要與 `0x20000000`一起設定相關的版本位。這隻能在軟分叉的開始時間之後進行。
如果任何一個軟分叉被激活，或達到 `[FAILED]` 狀態，位都應當被複原。

例如:

"盼弟" 軟分叉使用 0 號位元，即 `0x1` + `0x20000000`

|0|0|1|0|0| ... |0|0|0|0|0|0|0|0|0|1|

"張三李四" 軟分叉使用 1 號位元，即 `0x2` + `0x20000000`

|0|0|1|0|0| ... |0|0|0|0|0|0|0|0|1|0|

若要同時通知兩個軟分叉，使用 0x20000003 (i.e. 0x1 + 0x2 + 0x20000000*)

|0|0|1|0|0| ... |0|0|0|0|0|0|0|0|1|1|

*	註意如果一個在另一個之前被激活，你必須複原相關位並持續通知另外一方。如果一方激活失敗並且超時失效，你也應當複原該位。

## 它與一個ISM軟分叉有什麼區別?

IsSuperMajority() 或其簡寫ISM，是一個曆史遺留的軟分叉觸發器，一旦 1000 個礦塊中的 950 個已經被開發並提示新礦塊版本時，它就會激活新規則。

1.	一個IsSuperMajority()軟分叉將使所有使用前一個版本的區塊變成孤塊。例如，如果目前的版本是4，接下來的軟分叉引入使用版本5的區塊，那麼當激活（1000 個區塊中的950塊）狀態達到後，節點將拒絕所有使用版本4的區塊。
2.	一旦一個版本位的軟分叉達到激活狀態，節點會簡單地開始強製執行新規則，並且除非一個非信令塊違反了新的規則，否則不會將其變成孤快。
3.	ISM()在滾動的基礎上監視以前的1000個區塊； 每次難度調整時，版本位會檢查之前的2016個區塊。
4.	ISM()軟分叉不會失效。版本位軟分叉隻能在開始時間和超時之間激活。

## 礦工需要升級麼?

不用。除非 95% 的礦工都顯示已經就緒，否則一個 BIP9 軟分叉將不會激活。 如果一個軟分叉達到 [LOCKED_IN] 狀態, 也就是當絕大多數礦工都做好應變的準備了，剩餘的礦工應當在下一個難度調整之前（大約2個星期）升級。
未升級的礦工有産生無效區塊的風險，如果這些區塊不能驗證新生效的規則將會變成孤塊。

## 誰來為提議的不同更新版本分配版本位？

軟分叉是通過 [BIPs process][BIP1] 被提議的。現行的 BIP9 軟分叉提議存放在 [assignments page](https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki#deployments)

## 更多閱讀


{% include toc.html %}

- <http://rusty.ozlabs.org/?p=576>
- <https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki>
- <https://bitcointalk.org/index.php?topic=1067693.msg11446462#msg11446462>

{% include references.md %}
